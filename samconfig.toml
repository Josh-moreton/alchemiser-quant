# SAM configuration for The Alchemiser Quantitative Trading System
version = 0.1

[default.build.parameters]
beta_features = true
use_container = false

[default.deploy.parameters]
stack_name = "the-alchemiser-v2"
region = "us-east-1"
capabilities = "CAPABILITY_IAM CAPABILITY_NAMED_IAM"
disable_rollback = false
confirm_changeset = false
fail_on_empty_changeset = false
resolve_s3 = true
image_repositories = []

[dev.deploy.parameters]
stack_name = "the-alchemiser-v2-dev"
region = "us-east-1"
capabilities = "CAPABILITY_IAM CAPABILITY_NAMED_IAM"
disable_rollback = false
confirm_changeset = false
fail_on_empty_changeset = false
resolve_s3 = true
# Provide stage parameter required by the template.
parameter_overrides = [
	"Stage=dev",
]

[prod.deploy.parameters]
stack_name = "the-alchemiser-v2"
region = "us-east-1"
capabilities = "CAPABILITY_IAM CAPABILITY_NAMED_IAM"
disable_rollback = false
confirm_changeset = false
fail_on_empty_changeset = false
resolve_s3 = true
# Prod parameters required by the template; credentials loaded via Secrets Manager
parameter_overrides = [
	"Stage=prod",
]

[ephemeral.build.parameters]
beta_features = true
use_container = false

[ephemeral.deploy.parameters]
# Stack name will be provided dynamically via CLI
region = "us-east-1"
capabilities = "CAPABILITY_IAM CAPABILITY_NAMED_IAM"
disable_rollback = false
confirm_changeset = false
fail_on_empty_changeset = false
resolve_s3 = true
# Ephemeral parameters will be provided via CLI
parameter_overrides = [
	"Stage=ephemeral",
]

[microservices-dev.deploy.parameters]
stack_name = "the-alchemiser-microservices-dev"
s3_prefix = "the-alchemiser-microservices-dev"
region = "us-east-1"
capabilities = "CAPABILITY_IAM CAPABILITY_NAMED_IAM"
parameter_overrides = "Stage=\"dev\" Env=\"dev\""

[microservices-prod.deploy.parameters]
stack_name = "the-alchemiser-microservices-prod"
s3_prefix = "the-alchemiser-microservices-prod"
region = "us-east-1"
capabilities = "CAPABILITY_IAM CAPABILITY_NAMED_IAM"
parameter_overrides = "Stage=\"prod\" Env=\"prod\""
